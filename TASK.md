Задача.

Нужно сделать сервис для рассылки уведомлений об истекающих подписках.

Примерно за два дня до истечения срока подписки, нужно отправить письмо пользователю с текстом "{username}, you subscription is expiring".

Имеем следующее.

1. Таблица **users** в DB с пользователями (1 000 000 строк):
**username** — имя
**email** — емейл
**validts** — unix ts до которого действует ежемесячная подписка
**email_confirmed** — 0 или 1 в зависимости от того, подтвердил ли пользователь свой емейл по ссылке (пользователю после регистрации приходит письмо с уникальный ссылкой на указанный емейл, если он нажал на ссылку в емейле в этом поле устанавливается 1).
2. Таблица **emails** в DB с емейл даами:
**email** — емейл
**checked** — 0 или 1 (был ли проверен функцией check_email)
**valid** — 0 или 1 (является ли валидным)
3. Функция **check_email( $email )**
Проверяет емейл на валидность и возвращает 0 или 1. 
Функция работает от 1 секунды до 1 минуты. Вызов функции платный.
4. Функция **send_email( $email, $from, $to, $subj, $body )**
Отсылает емейл.
Функция работает от 1 секунды до 10 секунд.

Необходимо регулярно отправлять емейлы об истечении срока подписки, но только на те емейлы, на которые письмо точно дойдёт. 

Можно использовать cron. 

Можно создать необходимые таблицы в DB.

Можно использовать вызов [http://localhost/script.php](http://localhost/scipt.php) для вызова своих скриптов.

Для функция **check_email** и **send_email** нужно написать "заглушки".

Не нужно использовать ООП.

Код разместить в GitHub.